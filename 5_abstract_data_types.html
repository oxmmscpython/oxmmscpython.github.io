
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>5. Abstract data types &#8212; Object-oriented Programming  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/fenics.css" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/proof.js"></script>
    <script async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="6. Errors and exceptions" href="6_exceptions.html" />
    <link rel="prev" title="4. A matter of style" href="4_style.html" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0EFVH5C4DC"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-0EFVH5C4DC');
</script>
<link rel="stylesheet" href="_static/featured.css">


<link rel="shortcut icon" href="_static/icon.ico" />


  </head><body>
<div class="wrapper">
  <a href="index.html"><img src="_static/banner.png" width="900px" alt="FInAT Project Banner" /></a>
  <div id="access">
    <div class="menu">
      <ul>
          <li class="page_item"><a href="index.html" title="Book">Book</a></li>
          <li class="page_item"><a href="videos.html" title="Videos">Videos</a></li>
          <li class="page_item"><a href="exercises.html"
          title="Exercises">Exercises</a></li>
          <li class="page_item"><a href="installation.html" title="Installation">Installation</a></li>

      </ul>
    </div><!-- .menu -->
  </div><!-- #access -->
</div><!-- #wrapper -->


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="abstract-data-types">
<span id="id1"></span><h1><span class="section-number">5. </span>Abstract data types<a class="headerlink" href="#abstract-data-types" title="Permalink to this heading">¶</a></h1>
<p>In <a class="reference internal" href="3_objects.html#objects"><span class="std std-numref">Chapter 3</span></a>, we introduced the concept of <a class="reference internal" href="3_objects.html#term-type"><span class="xref std std-term">type</span></a> as an
<a class="reference internal" href="3_objects.html#term-abstraction"><span class="xref std std-term">abstraction</span></a> comprising a set of possible values, and a set of
operations. All types in Python are abstractions in this sense
because we deal with them in terms of their defined properties rather
than their actual implementation. However, it can also be useful to
define purely mathematical types, distinct from their concrete
realisation in code. Indeed, there are typically multiple possible
concrete realisations of a mathematical idea.</p>
<div class="proof proof-type-definition" id="id4">

    <div class="proof-title">
        <span class="proof-type">Definition 5.1</span>
        
            <span class="proof-title-name">(Abstract Data Type)</span>
        
    </div><div class="proof-content">
<p>An <em>abstract data type</em> is a purely mathematical <a class="reference internal" href="3_objects.html#term-type"><span class="xref std std-term">type</span></a>,
defined independently of its concrete realisation as code.</p>
</div></div><p>Abstract data types enable the programmer to reason about algorithms and their
cost separately from the task of implementing them. In contrast, we can also
define the concrete realisation of a data type:</p>
<div class="proof proof-type-definition" id="id5">

    <div class="proof-title">
        <span class="proof-type">Definition 5.2</span>
        
            <span class="proof-title-name">(Data structure)</span>
        
    </div><div class="proof-content">
<p>A <em>data structure</em> describes the concrete implementation of a data type:
which data is stored, in what order, and how it is interpreted.</p>
</div></div><p>In understanding abstract data types, it is often useful to think about the
data structures which could be used to implement them, but there is also value
in understanding an abstract type purely in terms of its mathematical
properties.</p>
<section id="stacks">
<span id="id2"></span><h2><span class="section-number">5.1. </span>Stacks<a class="headerlink" href="#stacks" title="Permalink to this heading">¶</a></h2>
<details>
<summary>
Video: stacks as an abstract data type.</summary><div class="video_wrapper" style="">
<iframe allowfullscreen="true" src="https://player.vimeo.com/video/506479213" style="border: 0; height: 345px; width: 560px">
</iframe></div></details><p>Possibly the simplest abstract data type which is not synonymous with
a Python type is the <a class="reference internal" href="#term-stack"><span class="xref std std-term">stack</span></a>. A stack is a sequence of objects
in which only the most recently added object is accessible. The image
to have in mind is a stack of plates on a spring-loaded holder of the
type found in many university and workplace canteens. Each time a
plate is added to the stack, the whole pile is <em>pushed</em> down to keep
the top of the stack in place. If the top plate is removed, then the
whole stack <em>pops</em> back up. An alternative name for a stack is
a <a class="reference internal" href="#term-LIFO-last-in-first-out"><span class="xref std std-term">LIFO (last in, first out)</span></a>, because the last object added to
the stack is the first object retrieved.</p>
<p>Recall that a <a class="reference internal" href="3_objects.html#term-type"><span class="xref std std-term">type</span></a> is defined by a set of possible values and a set of
operations. The value of stack is an ordered sequence of objects of any type.
The operations are <code class="xref py py-obj docutils literal notranslate"><span class="pre">push</span></code> to add a new object to the sequence, and <code class="xref py py-obj docutils literal notranslate"><span class="pre">pop</span></code> to
return the most recently added object, and remove it from the sequence.
<a class="reference internal" href="#stackdiag"><span class="std std-numref">Fig. 5.1</span></a> shows these operations. It is also common to add an
additional operation of <code class="xref py py-obj docutils literal notranslate"><span class="pre">peek</span></code>, which returns the most recently added object
without removing it from the stack.</p>
<figure class="align-default" id="id6">
<span id="stackdiag"></span><img alt="_images/stack.svg" src="_images/stack.svg" /><figcaption>
<p><span class="caption-number">Fig. 5.1 </span><span class="caption-text">A sequence of stack operations. 24, 12, and 57. Finally the pop operation
removes (and would return) 57.</span><a class="headerlink" href="#id6" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<section id="an-example-reverse-polish-notation">
<h3><span class="section-number">5.1.1. </span>An example: reverse Polish notation<a class="headerlink" href="#an-example-reverse-polish-notation" title="Permalink to this heading">¶</a></h3>
<p>Reverse Polish notation, or postfix notation, is a way of writing mathematical
operations without using operator precedence or brackets in order to determine
the order of operations. This makes the algorithm for evaluating expressions
written in reverse Polish notation arithmetic particularly simple. Reverse
Polish calculators require fewer button pushes for complex calculations and
were popular in the 1970s. They are still available, most famously from HP. In
a more current example, the PostScript language used to describe documents for
printers is written in reverse Polish notation.</p>
<p>In reverse Polish notation, the operator follows its operands. For
example to add the numbers one and two, one would write <span class="math notranslate nohighlight">\(1\ 2\
+\)</span>. Formally, a reverse Polish calculator comprises a set of numbers,
a set of operators (each of which takes a fixed number of arguments),
and a stack. Each number encountered in the expression is pushed onto
the stack, while each operator pops the right number of arguments off
the stack and pushes the result onto the stack. At the end of the
calculation, the result of the calculation is on the top of the stack.
<a class="reference internal" href="#rpcalc"><span class="std std-numref">Listing 5.1</span></a> shows <a class="reference internal" href="3_objects.html#term-pseudocode"><span class="xref std std-term">pseudocode</span></a> for a reverse Polish
calculator.</p>
<div class="literal-block-wrapper docutils container" id="id7">
<span id="rpcalc"></span><div class="code-block-caption"><span class="caption-number">Listing 5.1 </span><span class="caption-text">Pseudocode for a reverse Polish calculator implemented
using a <a class="reference internal" href="#term-stack"><span class="xref std std-term">stack</span></a></span><a class="headerlink" href="#id7" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">inputs</span><span class="p">:</span>
<span class="linenos">2</span>    <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="n">number</span><span class="p">:</span>
<span class="linenos">3</span>        <span class="n">stack</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">number</span><span class="p">)</span>
<span class="linenos">4</span>    <span class="k">elif</span> <span class="n">item</span> <span class="ow">is</span> <span class="n">operator</span><span class="p">:</span>
<span class="linenos">5</span>        <span class="n">operand2</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
<span class="linenos">6</span>        <span class="n">operand1</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
<span class="linenos">7</span>        <span class="n">stack</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">operand1</span> <span class="n">operator</span> <span class="n">operand2</span><span class="p">)</span>
<span class="linenos">8</span><span class="k">return</span> <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Notice that we pop the second operand before the first. This is
because <span class="math notranslate nohighlight">\(4\ 2\ -\)</span> means <span class="math notranslate nohighlight">\(4 - 2\)</span>, not <span class="math notranslate nohighlight">\(2 - 4\)</span>.
<a class="reference internal" href="#rptable"><span class="std std-numref">Table 5.1</span></a> shows how a reverse Polish calculator would evaluate
an arithmetic expression.</p>
<span id="rptable"></span><table class="docutils align-default" id="id8">
<caption><span class="caption-number">Table 5.1 </span><span class="caption-text">Evaluation of the reverse Polish expression
             <code class="xref py py-obj docutils literal notranslate"><span class="pre">6</span> <span class="pre">2</span> <span class="pre">/</span> <span class="pre">2</span> <span class="pre">4</span> <span class="pre">**</span> <span class="pre">+</span></code> using a stack
             (equivalent to <span class="math notranslate nohighlight">\(6/2 + 2^4 = 3 + 16 = 19\)</span>).</span><a class="headerlink" href="#id8" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 46.2%" />
<col style="width: 15.4%" />
<col style="width: 38.5%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Expression</p></th>
<th class="head"><p>Stack</p></th>
<th class="head"><p>Action</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">6</span> <span class="pre">2</span> <span class="pre">/</span> <span class="pre">2</span> <span class="pre">4</span> <span class="pre">**</span> <span class="pre">+</span></code></p></td>
<td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">()</span></code></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">2</span> <span class="pre">/</span> <span class="pre">2</span> <span class="pre">4</span> <span class="pre">**</span> <span class="pre">+</span></code></p></td>
<td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">(6)</span></code></p></td>
<td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">push</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">/</span> <span class="pre">2</span> <span class="pre">4</span> <span class="pre">**</span> <span class="pre">+</span></code></p></td>
<td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">(6</span> <span class="pre">2)</span></code></p></td>
<td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">push</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">2</span> <span class="pre">4</span> <span class="pre">**</span> <span class="pre">+</span></code></p></td>
<td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">(3)</span></code></p></td>
<td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">pop,</span> <span class="pre">pop,</span> <span class="pre">divide,</span> <span class="pre">push</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">4</span> <span class="pre">**</span> <span class="pre">+</span></code></p></td>
<td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">(3</span> <span class="pre">2)</span></code></p></td>
<td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">push</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">**</span> <span class="pre">+</span></code></p></td>
<td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">(3</span> <span class="pre">2</span> <span class="pre">4)</span></code></p></td>
<td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">push</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">+</span></code></p></td>
<td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">(3</span> <span class="pre">16)</span></code></p></td>
<td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">pop,</span> <span class="pre">pop,</span> <span class="pre">power,</span> <span class="pre">push</span></code></p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">(19)</span></code></p></td>
<td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">pop,</span> <span class="pre">pop,</span> <span class="pre">add,</span> <span class="pre">push</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="implementing-stacks-in-python">
<h3><span class="section-number">5.1.2. </span>Implementing stacks in Python<a class="headerlink" href="#implementing-stacks-in-python" title="Permalink to this heading">¶</a></h3>
<p>While it is strictly true that Python does not have a stack type, the
<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> class functions as a perfectly good stack. The
relationship between the two is shown in <a class="reference internal" href="#list-stack"><span class="std std-numref">Table 5.2</span></a>.</p>
<span id="list-stack"></span><table class="docutils align-default" id="id9">
<caption><span class="caption-number">Table 5.2 </span><span class="caption-text">Correspondence between abstract stack operations, and
             Python list operations. We assume a list called
             <code class="xref py py-obj docutils literal notranslate"><span class="pre">my_list</span></code></span><a class="headerlink" href="#id9" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 33.3%" />
<col style="width: 33.3%" />
<col style="width: 33.3%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Stack operation</p></th>
<th class="head"><p>List operation</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">push(x)</span></code></p></td>
<td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">my_list.append(x)</span></code></p></td>
<td><p>Add <code class="xref py py-obj docutils literal notranslate"><span class="pre">x</span></code> to the top of the stack.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">pop</span></code></p></td>
<td><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">my_list.pop()</span></code></p></td>
<td><p>Return and remove the top item on the stack.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">peek</span></code></p></td>
<td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">my_list[-1]</span></code></p></td>
<td><p>Return the last item on the stack, but leave the stack
unchanged.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">len(my_list)</span></code></p></td>
<td><p>Return the number of items on the stack. Not a strictly required
stack operation, but often useful.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="separation-of-concerns">
<h2><span class="section-number">5.2. </span>Separation of concerns<a class="headerlink" href="#separation-of-concerns" title="Permalink to this heading">¶</a></h2>
<p>At first sight, discussions of abstract data types can seem like a
complication of what, at the end of the day, are just operations on
some objects. Instead of talking about stacks, why don’t we just say
that a reverse Polish calculator can be implemented using a
<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>?</p>
<p>The critical conceptual difference here is that a
<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> is a Python construct, while a stack is a mathematical
concept with universal applicability. If you understand the concept of
a stack, then you will be able to use this to design algorithms and
write programs in other languages where the concrete implementation
might be a different type, or you might have to create your own stack
from lower-level types and operations.</p>
<p>This is an example of a fundamental computer science concept called
<a class="reference internal" href="#term-separation-of-concerns"><span class="xref std std-term">separation of concerns</span></a>. Separation of concerns is a design
principle that underpins much of what is considered to be good
practice in programming. The idea is to divide larger tasks into
smaller units, each responsible for doing one thing (addressing one
concern). Different units communicate with each other using
mathematically well-defined interfaces. This makes the internal design
of each unit more-or-less independent of the other units. Why is this
important? There are two key reasons. The first is that in
programming, as in maths, complexity is the enemy of
understanding. Directly addressing a large and complex problem is
likely to result in a large and complex piece of code which nobody
understands. Such a program will almost inevitably produce the wrong
answer, and finding out what is wrong will be exceptionally difficult.</p>
<p>Abstract data types provide part of the mathematical interface that separates
different concerns. The user of an abstract data type has an object with a
simple set of operations which is easy to reason about. At the same time, the
implementer of an abstract data type only has to provide an object with the
required methods: they do not have to reason about all the ways in which that
object might be used. By learning to think about programming in terms of
abstract types and objects, you will become a better programmer who can address
more complex programming tasks.</p>
</section>
<section id="algorithmic-complexity">
<h2><span class="section-number">5.3. </span>Algorithmic complexity<a class="headerlink" href="#algorithmic-complexity" title="Permalink to this heading">¶</a></h2>
<details>
<summary>
Video: dynamic arrays and algorithmic complexity.</summary><div class="video_wrapper" style="">
<iframe allowfullscreen="true" src="https://player.vimeo.com/video/506479208" style="border: 0; height: 345px; width: 560px">
</iframe></div></details><p>The second reason that understanding abstract data types is important
is that a good implementation of a well-designed abstract data type
will have well-defined performance characteristics. In particular, the
optimal algorithmic complexity, expressed in big <span class="math notranslate nohighlight">\(O\)</span> notation, of
operations on abstract data types will be known. Recall the definition
of big <span class="math notranslate nohighlight">\(O\)</span>:</p>
<div class="proof proof-type-definition" id="id10">
<span id="bigo"></span>
    <div class="proof-title">
        <span class="proof-type">Definition 5.3</span>
        
            <span class="proof-title-name">(<span class="math notranslate nohighlight">\(O\)</span>)</span>
        
    </div><div class="proof-content">
<p>Let <span class="math notranslate nohighlight">\(f\)</span>, <span class="math notranslate nohighlight">\(g\)</span>, be real-valued functions. Then:</p>
<div class="math notranslate nohighlight">
\[f(n) = O(g(n)) \textrm{ as } n\rightarrow \infty\]</div>
<p>if there exists <span class="math notranslate nohighlight">\(M&gt;0\)</span> and <span class="math notranslate nohighlight">\(N&gt;0\)</span> such that:</p>
<div class="math notranslate nohighlight">
\[n&gt;N\, \Rightarrow\, |f(n)| &lt; M g(n).\]</div>
</div></div><p>We use <span class="math notranslate nohighlight">\(n\)</span> rather than <span class="math notranslate nohighlight">\(x\)</span> as the independent variable,
because we are primarily interested in characterising the number of
primitive operations or the amount of memory that an algorithm will
use as a function of the number of objects stored in the relevant
abstract data type.</p>
<p>For example, in the Python <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> implementation, all of
the stack operations are, on average, <span class="math notranslate nohighlight">\(O(1)\)</span>. This means that
each of pushing, popping, and peeking has an approximately fixed cost
that does not depend on the current size of the stack. This does not
obviously have to be the case, especially for the push and pop
operations, which modify the stack. <a class="reference internal" href="#badstack"><span class="std std-numref">Listing 5.2</span></a> provides an
implementation of a stack in which the data is stored as a Python
<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>. Here, every time item is pushed onto or popped from
the stack, a new copy of the <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a> has to be made. This
touches every one of the <span class="math notranslate nohighlight">\(n\)</span> items currently in the stack, and
therefore costs <span class="math notranslate nohighlight">\(O(n)\)</span> operations. It is often useful to
distinguish between time complexity, which is an indication of the
number of operations required to execute an algorithm, and space
complexity, which measures the peak memory usage of an algorithm or
data structure.</p>
<div class="badcode docutils container">
<div class="literal-block-wrapper docutils container" id="id11">
<span id="badstack"></span><div class="code-block-caption"><span class="caption-number">Listing 5.2 </span><span class="caption-text">A poorly designed stack implementation in which push and pop cost
<span class="math notranslate nohighlight">\(O(n)\)</span> operations, where <span class="math notranslate nohighlight">\(n\)</span> is the current
number of objects on the stack.</span><a class="headerlink" href="#id11" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">class</span> <span class="nc">BadStack</span><span class="p">:</span>
<span class="linenos"> 2</span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos"> 3</span>        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">()</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span>    <span class="k">def</span> <span class="nf">push</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="linenos"> 6</span>        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">+=</span> <span class="p">(</span><span class="n">value</span><span class="p">,)</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span>    <span class="k">def</span> <span class="nf">pop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos"> 9</span>        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="linenos">10</span>        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="linenos">11</span>        <span class="k">return</span> <span class="n">value</span>
<span class="linenos">12</span>
<span class="linenos">13</span>    <span class="k">def</span> <span class="nf">peek</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos">14</span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You may already have seen big O notation in numerical analysis. The
distinction is that in analysing algorithmic complexity, the limit is taken
as <span class="math notranslate nohighlight">\(n\)</span> approaches infinity, while in numerical analysis the
independent variable approaches 0. This difference between two closely
related fields is often confusing, particularly since both disciplines
conventionally leave out the limit. It’s worth keeping in mind the
difference, because a numerical algorithm with <span class="math notranslate nohighlight">\(O(h^4)\)</span> error is
really rather good since <code class="xref py py-obj docutils literal notranslate"><span class="pre">h</span></code> is small, but an algorithm with <span class="math notranslate nohighlight">\(O(n^4)\)</span>
cost is very expensive indeed!</p>
</div>
<section id="amortised-complexity-and-worst-case-complexity">
<h3><span class="section-number">5.3.1. </span>Amortised complexity and worst case complexity<a class="headerlink" href="#amortised-complexity-and-worst-case-complexity" title="Permalink to this heading">¶</a></h3>
<p>The actual implementation of a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> is of a contiguous
sequence of locations in memory, each of which can hold a reference to
a Python object. How, then, can appending an item to a list work? The
next location in memory might already be in use for some other
data. The obvious naïve implementation would be to allocate a new
contiguous block of memory, one location longer than the previous one,
and copy the existing values into that before placing the appended
value in the final location. This amounts to the approach in
<a class="reference internal" href="#badstack"><span class="std std-numref">Listing 5.2</span></a>, with the result that appending an item to a list
would have a time complexity of <span class="math notranslate nohighlight">\(O(n)\)</span>.</p>
<p>In fact, this is not how Python lists are implemented. Instead of only
allocating the exact amount of memory needed, Python allocates a bit
more and keeps track of how many memory locations are currently in use
to implement the list. Only when all the current memory locations are
full does a further append operation cause Python to allocate more
memory. The amount of memory allocated is approximately proportional
to the current length of the list. That is, if the current list length
is <span class="math notranslate nohighlight">\(n\)</span> then the new memory allocation will be of size
approximately <span class="math notranslate nohighlight">\(kn\)</span> for some <span class="math notranslate nohighlight">\(k&gt;1\)</span>. This <a class="reference internal" href="#term-data-structure"><span class="xref std std-term">data structure</span></a> is
called a <a class="reference internal" href="#term-dynamic-array"><span class="xref std std-term">dynamic array</span></a>. <a class="reference internal" href="#dynamicarray"><span class="std std-numref">Fig. 5.2</span></a> illustrates its operation.</p>
<figure class="align-default" id="id12">
<span id="dynamicarray"></span><img alt="_images/dynamic_array.svg" src="_images/dynamic_array.svg" /><figcaption>
<p><span class="caption-number">Fig. 5.2 </span><span class="caption-text">A dynamic array implementation of a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>. The existing
memory buffer is full, so when 11 is appended to the list, a larger
buffer is created and the whole list is copied into it. When 13 is
subsequently appended to the list, there is still space in the buffer so
it is not necessary to copy the whole list.</span><a class="headerlink" href="#id12" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>What does this memory allocation strategy mean for the computational
complexity of appending items to the list? There are two cases. If
there is a spare location for the appended value, then a reference to
the value is simply inserted into that location. The cost of this does
not depend on the current length of the list, so it’s <span class="math notranslate nohighlight">\(O(1)\)</span>. If
all of the allocated memory locations are now in use, then a new chunk
of memory is allocated, and the existing values are copied there. This
is an <span class="math notranslate nohighlight">\(O(n)\)</span> operation. However, this <span class="math notranslate nohighlight">\(O(n)\)</span> operation
only occurs when the list has to be extended. How often is that?
Suppose the list has just been reallocated (at a cost of
<span class="math notranslate nohighlight">\(O(n)\)</span>). The new memory allocation is <span class="math notranslate nohighlight">\(kn\)</span> large, but we’ve
already used <span class="math notranslate nohighlight">\(n\)</span> locations so we get <span class="math notranslate nohighlight">\((k-1)n\)</span> more cheap
<span class="math notranslate nohighlight">\(O(1)\)</span> append operations before we have to reallocate
again. <span class="math notranslate nohighlight">\((k-1)n = O(n)\)</span> so this means that adding <span class="math notranslate nohighlight">\(O(n)\)</span>
items to the list costs:</p>
<div class="math notranslate nohighlight">
\[\underbrace{O(n)}_{\textrm{reallocation}} + \underbrace{O(n)\times O(1)}_{O(n) \textrm{ cheap appends.}} = O(n)\]</div>
<p>If appending <span class="math notranslate nohighlight">\(O(n)\)</span> items to a list has a time complexity of
<span class="math notranslate nohighlight">\(O(n)\)</span>, it follows that the cost of appending one item to a
list, averaged over a suitably large number of operations, is
<span class="math notranslate nohighlight">\(O(1)\)</span>. This measure of complexity, in which the cost of
occasional expensive operations is considered averaged over a large
number of operations, is called <a class="reference internal" href="#term-amortised-complexity"><span class="xref std std-term">amortised complexity</span></a>. In
contrast, the occasional reallocate and copy operation is an example of the
<a class="reference internal" href="#term-worst-case-complexity"><span class="xref std std-term">worst case complexity</span></a> of the algorithm. Appending an item to a
list has an amortised time complexity of <span class="math notranslate nohighlight">\(O(1)\)</span> but a worst-case
time complexity of <span class="math notranslate nohighlight">\(O(n)\)</span>.</p>
<p>We can use Python’s <a class="reference internal" href="#term-introspection"><span class="xref std std-term">introspection</span></a> capabilities to illustrate how the
dynamic allocation of space for a list works as the list is appended. The
<a class="reference external" href="https://docs.python.org/3/library/sys.html#sys.getsizeof" title="(in Python v3.11)"><code class="xref py py-func docutils literal notranslate"><span class="pre">sys.getsizeof()</span></code></a> function returns the amount of computer memory that an
object consumes. The function in <a class="reference internal" href="#byte-size"><span class="std std-numref">Listing 5.3</span></a> uses this to diagnose the
memory consumption of progressively longer lists, and <a class="reference internal" href="#byte-size-demo"><span class="std std-numref">Listing 5.4</span></a>
demonstrates this.</p>
<div class="literal-block-wrapper docutils container" id="id13">
<span id="byte-size"></span><div class="code-block-caption"><span class="caption-number">Listing 5.3 </span><span class="caption-text">Code to progressively lengthen a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> and observe the
impact on its memory consumption. This function is available as
<a class="reference internal" href="example_code.html#example_code.linked_list.byte_size" title="example_code.linked_list.byte_size"><code class="xref py py-func docutils literal notranslate"><span class="pre">example_code.linked_list.byte_size()</span></code></a>.</span><a class="headerlink" href="#id13" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">import</span> <span class="nn">sys</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="k">def</span> <span class="nf">byte_size</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="linenos"> 4</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;Print the size in bytes of lists up to length n.&quot;&quot;&quot;</span>
<span class="linenos"> 5</span>    <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="linenos"> 6</span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="linenos"> 7</span>        <span class="n">a</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="linenos"> 8</span>        <span class="n">b</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="linenos"> 9</span>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Length:</span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2">; Size in bytes:</span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">10</span>        <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id14">
<span id="byte-size-demo"></span><div class="code-block-caption"><span class="caption-number">Listing 5.4 </span><span class="caption-text">The memory consumption of lists of length 0 to 19. We can infer
that the list is reallocated at lengths 1, 5, 9, and 17.</span><a class="headerlink" href="#id14" title="Permalink to this code">¶</a></div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">from</span> <span class="nn">example_code.linked_list</span> <span class="kn">import</span> <span class="n">byte_size</span>

<span class="gp">In [2]: </span><span class="n">byte_size</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">Length:0; Size in bytes:56</span>
<span class="go">Length:1; Size in bytes:88</span>
<span class="go">Length:2; Size in bytes:88</span>
<span class="go">Length:3; Size in bytes:88</span>
<span class="go">Length:4; Size in bytes:88</span>
<span class="go">Length:5; Size in bytes:120</span>
<span class="go">Length:6; Size in bytes:120</span>
<span class="go">Length:7; Size in bytes:120</span>
<span class="go">Length:8; Size in bytes:120</span>
<span class="go">Length:9; Size in bytes:184</span>
<span class="go">Length:10; Size in bytes:184</span>
<span class="go">Length:11; Size in bytes:184</span>
<span class="go">Length:12; Size in bytes:184</span>
<span class="go">Length:13; Size in bytes:184</span>
<span class="go">Length:14; Size in bytes:184</span>
<span class="go">Length:15; Size in bytes:184</span>
<span class="go">Length:16; Size in bytes:184</span>
<span class="go">Length:17; Size in bytes:256</span>
<span class="go">Length:18; Size in bytes:256</span>
<span class="go">Length:19; Size in bytes:256</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="queues-and-deques">
<h2><span class="section-number">5.4. </span>Queues and deques<a class="headerlink" href="#queues-and-deques" title="Permalink to this heading">¶</a></h2>
<details>
<summary>
Video: deques and ring buffers.</summary><div class="video_wrapper" style="">
<iframe allowfullscreen="true" src="https://player.vimeo.com/video/506710190" style="border: 0; height: 345px; width: 560px">
</iframe></div></details><p>A <a class="reference internal" href="#term-queue"><span class="xref std std-term">queue</span></a> is, like a <a class="reference internal" href="#term-stack"><span class="xref std std-term">stack</span></a>, an ordered sequence of
objects. The difference is that the only accessible item in the
sequence is the <em>earliest</em> added. Items can be added to the back of
the queue and taken from the front. As with a stack, the optimal
implementations of item insertion and removal are <span class="math notranslate nohighlight">\(O(1)\)</span>.</p>
<p>A <a class="reference internal" href="#term-deque"><span class="xref std std-term">deque</span></a> (Double Ended QUEue) is a generalisation of a queue to
permit adding and removing items at either end. The observant
reader will note that stacks and queues are both special cases of
deques. Python’s standard library contains the
<a class="reference external" href="https://docs.python.org/3/library/collections.html#collections.deque" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.deque</span></code></a> class, providing a simple and efficient
implementation of a deque.</p>
<section id="ring-buffers">
<h3><span class="section-number">5.4.1. </span>Ring buffers<a class="headerlink" href="#ring-buffers" title="Permalink to this heading">¶</a></h3>
<p>How might one go about implementing a deque? A dynamic array allows values to
be appended with <span class="math notranslate nohighlight">\(O(1)\)</span> complexity, but doesn’t offer an efficient
mechanism for prepending values. One might think that the natural solution for
this would be to create a double-ended dynamic array: a buffer with spare space
at each end. Unfortunately this is not optimally efficient in the case where
the deque is used to implement a queue of approximately constant length. In
that case, values are consistently added at one end of the <a class="reference internal" href="#term-data-structure"><span class="xref std std-term">data
structure</span></a> and removed from the other. Even in the case of a double-ended
dynamic array, the buffer space at the append end of the queue will constantly
run out, necessitating an expensive copy operation. The solution is to use a
dynamic array, but to logically join up its ends, so that the first position in
the buffer follows on from the last. Only in the case where all positions in
the buffer are full will the buffer be reallocated. This data structure is
called a ring buffer.</p>
<figure class="align-default" id="id15">
<span id="ring-buffer"></span><img alt="_images/ring_buffer.svg" src="_images/ring_buffer.svg" /><figcaption>
<p><span class="caption-number">Fig. 5.3 </span><span class="caption-text">An implementation of a ring buffer, with queue
operations illustrating its operation.</span><a class="headerlink" href="#id15" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p><a class="reference internal" href="#ring-buffer"><span class="std std-numref">Fig. 5.3</span></a> shows a ring buffer being used as a queue. At each step,
an object is appended to the end of the queue, or removed from its start. At
step 7, the contents of the buffer wrap around: the queue at this stage contains
<code class="xref py py-obj docutils literal notranslate"><span class="pre">D,</span> <span class="pre">E,</span> <span class="pre">F</span></code>. At step 9 there is insufficient space in the buffer to append <code class="xref py py-obj docutils literal notranslate"><span class="pre">G</span></code>, so
new space is allocated and the buffer’s contents copied to the start of the new
buffer.</p>
</section>
</section>
<section id="linked-lists">
<h2><span class="section-number">5.5. </span>Linked lists<a class="headerlink" href="#linked-lists" title="Permalink to this heading">¶</a></h2>
<details>
<summary>
Video: linked lists.</summary><div class="video_wrapper" style="">
<iframe allowfullscreen="true" src="https://player.vimeo.com/video/506743244" style="border: 0; height: 345px; width: 560px">
</iframe></div></details><p>One disadvantage of a deque (and hence of a stack or queue) is that inserting an
object into the middle of the sequence is often an <span class="math notranslate nohighlight">\(O(n)\)</span> operation,
because on average half of the items in the sequence need to be shuffled to make
space. A linked list provides a mechanism for avoiding this. A singly linked
list is a collection of links. Each link contains a reference to a data item and
a reference to the next link. Starting from the first link in a list, it is
possible to move along the list by following the references to successive
further links. A new item can be inserted at the current point in the list by
creating a new link, pointing the link reference of the new link to the next
link, and pointing the link reference of the current link to the new link.
<a class="reference internal" href="#linked-list-dia"><span class="std std-numref">Fig. 5.4</span></a> shows this process, while <a class="reference internal" href="#linked-list"><span class="std std-numref">Listing 5.5</span></a> shows
a minimal implementation of a linked list in Python. Notice that there is no
object for the list itself: a linked list is simply a linked set of links. Some
linked list implementations do store an object for the list itself, in order to
record convenient information such as the list length, but it’s not strictly necessary.</p>
<figure class="align-default" id="id16">
<span id="linked-list-dia"></span><img alt="_images/linked_list.svg" src="_images/linked_list.svg" /><figcaption>
<p><span class="caption-number">Fig. 5.4 </span><span class="caption-text">Diagram of a linked list. A new link containing the value <code class="xref py py-obj docutils literal notranslate"><span class="pre">E</span></code> is
inserted between the link with value <code class="xref py py-obj docutils literal notranslate"><span class="pre">B</span></code> and that with value <code class="xref py py-obj docutils literal notranslate"><span class="pre">C</span></code>. First,
the link reference from <code class="xref py py-obj docutils literal notranslate"><span class="pre">E</span></code> is pointed to <code class="xref py py-obj docutils literal notranslate"><span class="pre">C</span></code> (blue dashed line). Next,
the link reference from <code class="xref py py-obj docutils literal notranslate"><span class="pre">B</span></code> is pointed to <code class="xref py py-obj docutils literal notranslate"><span class="pre">E</span></code> (red dotted line).</span><a class="headerlink" href="#id16" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<div class="literal-block-wrapper docutils container" id="linked-list">
<div class="code-block-caption"><span class="caption-number">Listing 5.5 </span><span class="caption-text">A simple singly linked list implementation.</span><a class="headerlink" href="#linked-list" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">class</span> <span class="nc">Link</span><span class="p">:</span>
<span class="linenos"> 2</span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="nb">next</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="linenos"> 3</span>       <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
<span class="linenos"> 4</span>       <span class="bp">self</span><span class="o">.</span><span class="n">next</span> <span class="o">=</span> <span class="nb">next</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span>    <span class="k">def</span> <span class="nf">insert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">link</span><span class="p">):</span>
<span class="linenos"> 7</span><span class="w">       </span><span class="sd">&#39;&#39;&#39;Insert a new link after the current one.&#39;&#39;&#39;</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span>       <span class="n">link</span><span class="o">.</span><span class="n">next</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span>
<span class="linenos">10</span>       <span class="bp">self</span><span class="o">.</span><span class="n">next</span> <span class="o">=</span> <span class="n">link</span>
</pre></div>
</div>
</div>
<p>Linked lists tend to have advantages where data is sparse. For example, our
implementation of a <a class="reference internal" href="example_code.html#example_code.polynomial.Polynomial" title="example_code.polynomial.Polynomial"><code class="xref py py-class docutils literal notranslate"><span class="pre">Polynomial</span></code></a> in
<a class="reference internal" href="3_objects.html#objects"><span class="std std-numref">Chapter 3</span></a> would represent <span class="math notranslate nohighlight">\(x^{100} + 1\)</span> very
inefficiently, with 98 zeroes. Squaring this polynomial would cause tens of
thousands of operations, almost all of them on zeroes. Conversely, if we
implemented polynomials with linked lists of terms, this squaring operation
would take the handful of operations we expect.</p>
<p>A doubly linked list differs from a singly linked list in that each
link contains links both to the next link and to the previous
one. This enables the list to be traversed both forwards and
backwards.</p>
<p>A <a class="reference internal" href="#term-deque"><span class="xref std std-term">deque</span></a>, and therefore a <a class="reference internal" href="#term-stack"><span class="xref std std-term">stack</span></a> or a <a class="reference internal" href="#term-queue"><span class="xref std std-term">queue</span></a> can
be implemented using a linked list, however the constant creation of
new link objects is typically less efficient than implementations
based on ring buffers.</p>
</section>
<section id="the-iterator-protocol">
<span id="iterator-protocol"></span><h2><span class="section-number">5.6. </span>The iterator protocol<a class="headerlink" href="#the-iterator-protocol" title="Permalink to this heading">¶</a></h2>
<details>
<summary>
Video: the iterator protocol.</summary><div class="video_wrapper" style="">
<iframe allowfullscreen="true" src="https://player.vimeo.com/video/506743250" style="border: 0; height: 345px; width: 560px">
</iframe></div></details><p>The abstract data types we have considered here are collections of
objects, and one common abstract operation which is applicable to
collections is to iterate over them. That is to say, to loop over the
objects in the collection and perform some action for each one. This
operation is sufficiently common that Python provides a special syntax
for it: the <a class="reference external" href="https://docs.python.org/3/reference/compound_stmts.html#for" title="(in Python v3.11)"><span class="xref std std-ref">for loop</span></a>. You will already be very
familiar with looping over sequences such as lists:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="k">for</span> <span class="n">planet</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;World&quot;</span><span class="p">,</span> <span class="s2">&quot;Mars&quot;</span><span class="p">,</span> <span class="s2">&quot;Venus&quot;</span><span class="p">]:</span>
<span class="gp">   ...: </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Hello </span><span class="si">{</span><span class="n">planet</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">   ...:</span>
<span class="go">Hello World</span>
<span class="go">Hello Mars</span>
<span class="go">Hello Venus</span>
</pre></div>
</div>
<p>Python offers a useful abstraction of this concept. By implementing the correct
<a class="reference internal" href="3_objects.html#term-special-method"><span class="xref std std-term">special methods</span></a>, a container class can provide the
ability to be iterated over. This is a great example of abstraction in action:
the user doesn’t need to know or care how a particular container is implemented
and therefore how to find all of its contents, they can simply write a for loop
to access every item in turn.</p>
<p>There are two <a class="reference internal" href="3_objects.html#term-special-method"><span class="xref std std-term">special methods</span></a> required for iteration.
Neither take any arguments beyond the object itself. The first,
<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#container.__iter__" title="(in Python v3.11)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__iter__()</span></code></a>, needs to be implemented by the container type. Its
role is to return an object which implements iteration. This could be the
container itself, or it could be a special iteration object (for example
because it is necessary to store a number recording where the iteration is up
to).</p>
<p>The object returned by <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#container.__iter__" title="(in Python v3.11)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__iter__()</span></code></a> is called an iterator. It
also needs to implement <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#iterator.__iter__" title="(in Python v3.11)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__iter__()</span></code></a> (for example it could simply
<code class="xref py py-obj docutils literal notranslate"><span class="pre">return</span> <span class="pre">self</span></code>). In addition, it needs to implement the
<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#iterator.__next__" title="(in Python v3.11)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__next__()</span></code></a> method. This is called by Python repeatedly to
obtain the next object in the iteration sequence. Once the sequence is
exhausted, subsequent calls to <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#iterator.__next__" title="(in Python v3.11)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__next__()</span></code></a> should raise the
built-in <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#StopIteration" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">StopIteration</span></code></a> exception. This tells Python that the iteration
is over. This arrangement is called the iterator protocol, and it’s further
documented in the <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#typeiter" title="(in Python v3.11)"><span class="xref std std-ref">official Python documentation</span></a>.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Raising exceptions is the subject of <a class="reference internal" href="6_exceptions.html#raising-exceptions"><span class="std std-numref">Section 6.4</span></a>,
to which we will turn presently. For current purposes, it is
sufficient to know that iteration is halted when <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#iterator.__next__" title="(in Python v3.11)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__next__()</span></code></a>
executes this line of code:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">raise</span> <span class="ne">StopIteration</span>
</pre></div>
</div>
</div>
<p>Let’s suppose we want to make the linked list in <a class="reference internal" href="#linked-list"><span class="std std-numref">Listing 5.5</span></a>
iterable. We’ll need to make another object (an iterator) to keep track of
where we are in the list at each point in the iteration.
<a class="reference internal" href="#iterating-linked-list"><span class="std std-numref">Listing 5.6</span></a> shows the code. The iterator class
<code class="xref py py-class docutils literal notranslate"><span class="pre">LinkIterator</span></code> is never seen by the user, it’s just there to keep track
of the iteration.</p>
<div class="literal-block-wrapper docutils container" id="id17">
<span id="iterating-linked-list"></span><div class="code-block-caption"><span class="caption-number">Listing 5.6 </span><span class="caption-text">A simple linked list implementation that supports the iterator
protocol.</span><a class="headerlink" href="#id17" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">class</span> <span class="nc">Link</span><span class="p">:</span>
<span class="linenos"> 2</span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="nb">next</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="linenos"> 3</span>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
<span class="linenos"> 4</span>        <span class="bp">self</span><span class="o">.</span><span class="n">next</span> <span class="o">=</span> <span class="nb">next</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span>    <span class="k">def</span> <span class="nf">insert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">link</span><span class="p">):</span>
<span class="linenos"> 7</span><span class="w">        </span><span class="sd">&#39;&#39;&#39;Insert a new link after the current one.&#39;&#39;&#39;</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span>        <span class="n">link</span><span class="o">.</span><span class="n">next</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span>
<span class="linenos">10</span>        <span class="bp">self</span><span class="o">.</span><span class="n">next</span> <span class="o">=</span> <span class="n">link</span>
<span class="linenos">11</span>
<span class="linenos">12</span>    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos">13</span>        <span class="k">return</span> <span class="n">LinkIterator</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="linenos">14</span>
<span class="linenos">15</span>
<span class="linenos">16</span><span class="k">class</span> <span class="nc">LinkIterator</span><span class="p">:</span>
<span class="linenos">17</span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">link</span><span class="p">):</span>
<span class="linenos">18</span>        <span class="bp">self</span><span class="o">.</span><span class="n">here</span> <span class="o">=</span> <span class="n">link</span>
<span class="linenos">19</span>
<span class="linenos">20</span>    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos">21</span>        <span class="k">return</span> <span class="bp">self</span>
<span class="linenos">22</span>
<span class="linenos">23</span>    <span class="k">def</span> <span class="fm">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos">24</span>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">here</span><span class="p">:</span>
<span class="linenos">25</span>            <span class="nb">next</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">here</span>
<span class="linenos">26</span>            <span class="bp">self</span><span class="o">.</span><span class="n">here</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">here</span><span class="o">.</span><span class="n">next</span>
<span class="linenos">27</span>            <span class="k">return</span> <span class="nb">next</span><span class="o">.</span><span class="n">value</span>
<span class="linenos">28</span>        <span class="k">else</span><span class="p">:</span>
<span class="linenos">29</span>            <span class="k">raise</span> <span class="ne">StopIteration</span>
</pre></div>
</div>
</div>
<p>As a trivial example, we can set up a short linked list and iterate over it, printing its values:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="gp">In [3]: </span><span class="n">linked_list</span> <span class="o">=</span> <span class="n">Link</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Link</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">Link</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>

<span class="gp">In [4]: </span><span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">linked_list</span><span class="p">:</span>
<span class="go">...:     print(l)</span>
<span class="go">...:</span>
<span class="go">1</span>
<span class="go">2</span>
<span class="go">3</span>
</pre></div>
</div>
<p>Indeed, since Python now knows how to iterate over our linked list,
converting it to a sequence type such as a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a> will now work
automatically:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="gp">In [5]: </span><span class="nb">tuple</span><span class="p">(</span><span class="n">linked_list</span><span class="p">)</span>
<span class="gh">Out[5]: </span><span class="go">(1, 2, 3)</span>
</pre></div>
</div>
</section>
<section id="other-abstract-data-types">
<h2><span class="section-number">5.7. </span>Other abstract data types<a class="headerlink" href="#other-abstract-data-types" title="Permalink to this heading">¶</a></h2>
<p>Here we have introduced in some detail a few relatively simple abstract data
types that illustrate the distinction between the mathematical properties of a
type and the concrete details of its implementation. There are many other
abstract data types, some of which you will have already met, and we will
encounter a few more in this course. For context, here are a few other
examples.</p>
<dl class="simple">
<dt>set</dt><dd><p>A set is an unordered collection of objects with the property that objects
that compare equal can only occur once in the set. Inserting or accessing a
set member has <span class="math notranslate nohighlight">\(O(1)\)</span> <a class="reference internal" href="#term-amortised-complexity"><span class="xref std std-term">amortised complexity</span></a>. Python provides the
<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">set</span></code></a> built in class as an implementation.</p>
</dd>
<dt>dictionary or map</dt><dd><p>A generalised function in which unique (up to equality) keys are mapped to
arbitrary values. Again, insertion and deletion cost <span class="math notranslate nohighlight">\(O(1)\)</span>
operations on average. The Python <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> type is an implementation.</p>
</dd>
<dt>graph</dt><dd><p>A general relation between a set and itself defined by a set of vertices
and a set of edges, where each edge connects exactly two vertices. Graphs
can be used to describe very general relationships among data.</p>
</dd>
<dt>tree</dt><dd><p>A particular sort of graph in which edges have a direction (a from and a to
node), and each node is the origin of at most one edge. Trees can be used
to describe many types of structured relationship. We will show how trees
and related structures can be used in symbolic maths in <a class="reference internal" href="9_trees_and_directed_acyclic_graphs.html#trees"><span class="std std-numref">Chapter 9</span></a>.</p>
</dd>
</dl>
</section>
<section id="glossary">
<h2><span class="section-number">5.8. </span>Glossary<a class="headerlink" href="#glossary" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><dl class="simple glossary">
<dt id="term-abstract-data-type">abstract data type<a class="headerlink" href="#term-abstract-data-type" title="Permalink to this term">¶</a></dt><dd><p>A mathematical <a class="reference internal" href="3_objects.html#term-type"><span class="xref std std-term">type</span></a>, defined independently of any
concrete implementation in code. Contrast <a class="reference internal" href="#term-data-structure"><span class="xref std std-term">data structure</span></a></p>
</dd>
<dt id="term-algorithmic-complexity">algorithmic complexity<a class="headerlink" href="#term-algorithmic-complexity" title="Permalink to this term">¶</a></dt><dd><p>A measure of the number of operations (time complexity) or
amount of storage (space complexity) required by an algorithm
or data structure. Algorithmic complexity is usually stated in
terms of a bound given in big ‘O’ notation.</p>
</dd>
<dt id="term-amortised-complexity">amortised complexity<a class="headerlink" href="#term-amortised-complexity" title="Permalink to this term">¶</a></dt><dd><p>The average complexity of an algorithm considered over a suitably
large number of invocations of that algorithm. Amortised
complexity takes into account circumstances where the worst case
complexity of an algorithm is known to occur only rarely.</p>
</dd>
<dt id="term-data-structure">data structure<a class="headerlink" href="#term-data-structure" title="Permalink to this term">¶</a></dt><dd><p>The concrete implementation of a data type in code. The data structure
is the organisation of the actual information in the computer’s memory
or on disk. Contrast <a class="reference internal" href="#term-abstract-data-type"><span class="xref std std-term">abstract data type</span></a>.</p>
</dd>
<dt id="term-deque">deque<a class="headerlink" href="#term-deque" title="Permalink to this term">¶</a></dt><dd><p>A double ended queue. An <a class="reference internal" href="#term-abstract-data-type"><span class="xref std std-term">abstract data type</span></a>
representing an ordered sequence in which objects can be added
or removed at either end. A deque is a generalisation of both a
<a class="reference internal" href="#term-stack"><span class="xref std std-term">stack</span></a> and a <a class="reference internal" href="#term-queue"><span class="xref std std-term">queue</span></a>.</p>
</dd>
<dt id="term-dynamic-array">dynamic array<a class="headerlink" href="#term-dynamic-array" title="Permalink to this term">¶</a></dt><dd><p>A <a class="reference internal" href="#term-data-structure"><span class="xref std std-term">data structure</span></a> for efficiently storing a variable length
sequence of values. A fixed length piece of memory, called a buffer, is reserved for the
sequence. If the number of items exceeds the size of the buffer then a
larger buffer is reserved, the contents of the sequence are copied over,
and the original buffer is returned to the system.</p>
</dd>
<dt id="term-introspection">introspection<a class="headerlink" href="#term-introspection" title="Permalink to this term">¶</a></dt><dd><p>The ability to inspect the implementation of a program from inside that
program while it is running.</p>
</dd>
<dt id="term-queue">queue<a class="headerlink" href="#term-queue" title="Permalink to this term">¶</a></dt><dt id="term-FIFO-first-in-first-out">FIFO (first in, first out)<a class="headerlink" href="#term-FIFO-first-in-first-out" title="Permalink to this term">¶</a></dt><dd><p>An <a class="reference internal" href="#term-abstract-data-type"><span class="xref std std-term">abstract data type</span></a> representing an ordered sequence
of objects in which objects are accessed in the order in which
they were added.</p>
</dd>
<dt id="term-ring-buffer">ring buffer<a class="headerlink" href="#term-ring-buffer" title="Permalink to this term">¶</a></dt><dd><p>A generalisation of a <a class="reference internal" href="#term-dynamic-array"><span class="xref std std-term">dynamic array</span></a> in which two ends of the
memory buffer are considered connected in order to enable the sequence
to be efficiently lengthened or shortened at either end.</p>
</dd>
<dt id="term-separation-of-concerns">separation of concerns<a class="headerlink" href="#term-separation-of-concerns" title="Permalink to this term">¶</a></dt><dd><p>A design principle under which individual components each
address a specific well defined need and communicate through
well defined interfaces with other components. Separation of
concerns enables reasoning about one part of a problem
independently of other parts.</p>
</dd>
<dt id="term-stack">stack<a class="headerlink" href="#term-stack" title="Permalink to this term">¶</a></dt><dt id="term-LIFO-last-in-first-out">LIFO (last in, first out)<a class="headerlink" href="#term-LIFO-last-in-first-out" title="Permalink to this term">¶</a></dt><dd><p>An <a class="reference internal" href="#term-abstract-data-type"><span class="xref std std-term">abstract data type</span></a> representing an ordered sequence
of objects, in which only the most recently added object can be
directly accessed.</p>
</dd>
<dt id="term-worst-case-complexity">worst case complexity<a class="headerlink" href="#term-worst-case-complexity" title="Permalink to this term">¶</a></dt><dd><p>An upper bound on the <a class="reference internal" href="#term-algorithmic-complexity"><span class="xref std std-term">algorithmic complexity</span></a> of an
algorithm. Many algorithms have a relatively low algorithmic
complexity most of the times they are run, but for some inputs
are much more complex. <a class="reference internal" href="#term-amortised-complexity"><span class="xref std std-term">amortised complexity</span></a> is a
mechanism for taking into account the frequency at which the
worst case complexity can be expected to occur.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="exercises">
<h2><span class="section-number">5.9. </span>Exercises<a class="headerlink" href="#exercises" title="Permalink to this heading">¶</a></h2>
<p>Using the information on the <a class="reference external" href="https://oxmmscpython.github.io/exercises.html">book website</a>
obtain the skeleton code for these exercises. You will also need to install
the pytest-timeout package.</p>
<div class="proof proof-type-exercise" id="id18">

    <div class="proof-title">
        <span class="proof-type">Exercise 5.4</span>
        
    </div><div class="proof-content">
<p>In the exercise repository, create a <a class="reference internal" href="2_programs_in_files.html#term-package"><span class="xref std std-term">package</span></a> called
<code class="xref py py-mod docutils literal notranslate"><span class="pre">adt_examples</span></code> with a <a class="reference internal" href="2_programs_in_files.html#term-module"><span class="xref std std-term">module</span></a> called
<code class="xref py py-mod docutils literal notranslate"><span class="pre">adt_examples.fibonacci</span></code>. Make the package installable and install it
in editable mode. Create a class <code class="xref py py-class docutils literal notranslate"><span class="pre">Fib</span></code> implementing the iterator
protocol which returns the Fibonacci numbers. In other words, the following
code should print the <code class="xref py py-obj docutils literal notranslate"><span class="pre">Fibonacci</span></code> numbers under 100:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">adt_examples.fibonacci</span> <span class="kn">import</span> <span class="n">Fib</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">Fib</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;=</span> <span class="mi">100</span><span class="p">:</span>
        <span class="k">break</span>
</pre></div>
</div>
<p>Obviously the Fibonacci sequence is infinite, so your iterator will never
raise <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#StopIteration" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">StopIteration</span></code></a>. Make sure that calculating the next number is
always a <span class="math notranslate nohighlight">\(O(1)\)</span> operation: don’t recalculate from 1 each time.</p>
</div></div><div class="proof proof-type-exercise" id="id19">

    <div class="proof-title">
        <span class="proof-type">Exercise 5.5</span>
        
    </div><div class="proof-content">
<p>In the exercise repository, create a <a class="reference internal" href="2_programs_in_files.html#term-module"><span class="xref std std-term">module</span></a>
<code class="xref py py-mod docutils literal notranslate"><span class="pre">adt_examples.rpcalc</span></code> containing a class <code class="xref py py-class docutils literal notranslate"><span class="pre">RPCalc</span></code> implementing a
reverse Polish calculator. The calculator should have the following methods:</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">push(n)</span></code></dt><dd><p>This takes a single argument. If it is a number then it should be
pushed onto the calculator’s internal stack. If it is the string for a
recognised operator, then the appropriate number of operands should be
popped from the internal stack, and the result pushed back on the
stack. Your calculator should support the following operators: <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;+&quot;</span></code>,
<code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;-&quot;</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;*&quot;</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;/&quot;</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;sin&quot;</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;cos&quot;</span></code>. This method should not return
anything.</p>
</dd>
<dt><code class="xref py py-meth docutils literal notranslate"><span class="pre">pop()</span></code></dt><dd><p>This method, which takes no arguments, should pop the top item on the
internal stack and return it.</p>
</dd>
<dt><code class="xref py py-meth docutils literal notranslate"><span class="pre">peek()</span></code></dt><dd><p>This method, which takes no arguments, should return the top item on the
internal stack without popping it.</p>
</dd>
<dt><code class="xref py py-meth docutils literal notranslate"><span class="pre">__len__()</span></code></dt><dd><p>This is the <a class="reference external" href="https://docs.python.org/3/reference/datamodel.html#object.__len__" title="(in Python v3.11)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__len__()</span></code></a> <a class="reference internal" href="3_objects.html#term-special-method"><span class="xref std std-term">special method</span></a>, which takes no
arguments but returns the length of the object. In this case, the length
of the calculator is defined to be the number of items on its internal stack.</p>
</dd>
</dl>
</div></div><div class="proof proof-type-exercise" id="id20">

    <div class="proof-title">
        <span class="proof-type">Exercise 5.6</span>
        
    </div><div class="proof-content">
<p>In the exercise repository, create a <a class="reference internal" href="2_programs_in_files.html#term-module"><span class="xref std std-term">module</span></a>
<code class="xref py py-mod docutils literal notranslate"><span class="pre">adt_examples.deque</span></code> containing a class <code class="xref py py-class docutils literal notranslate"><span class="pre">Deque</span></code> implementing a
<a class="reference internal" href="#term-deque"><span class="xref std std-term">deque</span></a>. Your implementation should use a ring buffer implemented
as a Python list. In order to make things somewhat simpler, we will use a
fixed size ring buffer, which doesn’t grow and shrink with the queue. The
<a class="reference internal" href="3_objects.html#term-constructor"><span class="xref std std-term">constructor</span></a> of your <code class="xref py py-class docutils literal notranslate"><span class="pre">Deque</span></code> should take a single integer
argument which is the size of the list you will use as your ring buffer.</p>
<p>Implement the following methods:</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">append(x)</span></code></dt><dd><p>Append <code class="xref py py-obj docutils literal notranslate"><span class="pre">x</span></code> to the end of the <code class="xref py py-class docutils literal notranslate"><span class="pre">Deque</span></code></p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">appendleft(x)</span></code></dt><dd><p>Append <code class="xref py py-obj docutils literal notranslate"><span class="pre">x</span></code> to the start of the <code class="xref py py-class docutils literal notranslate"><span class="pre">Deque</span></code></p>
</dd>
<dt><code class="xref py py-meth docutils literal notranslate"><span class="pre">pop()</span></code></dt><dd><p>Remove the last item in the <code class="xref py py-class docutils literal notranslate"><span class="pre">Deque</span></code> and return it.</p>
</dd>
<dt><code class="xref py py-meth docutils literal notranslate"><span class="pre">popleft()</span></code></dt><dd><p>Remove the first item in the <code class="xref py py-class docutils literal notranslate"><span class="pre">Deque</span></code> and return it.</p>
</dd>
<dt><code class="xref py py-meth docutils literal notranslate"><span class="pre">peek()</span></code></dt><dd><p>Return the last item in the <code class="xref py py-class docutils literal notranslate"><span class="pre">Deque</span></code> without removing it.</p>
</dd>
<dt><code class="xref py py-meth docutils literal notranslate"><span class="pre">peekleft()</span></code></dt><dd><p>Return the first item in the <code class="xref py py-class docutils literal notranslate"><span class="pre">Deque</span></code> without removing it.</p>
</dd>
<dt><code class="xref py py-meth docutils literal notranslate"><span class="pre">__len__()</span></code></dt><dd><p>The <a class="reference external" href="https://docs.python.org/3/reference/datamodel.html#object.__len__" title="(in Python v3.11)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__len__()</span></code></a> <a class="reference internal" href="3_objects.html#term-special-method"><span class="xref std std-term">special method</span></a>. This should return
the number of items currently in the <code class="xref py py-class docutils literal notranslate"><span class="pre">Deque</span></code>.</p>
</dd>
</dl>
<p>In addition to the above methods, you should ensure that <code class="xref py py-class docutils literal notranslate"><span class="pre">Deque</span></code>
implements the iterator protocol. This should return the items in the queue,
starting from the first to the last. Iterating over the
<code class="xref py py-class docutils literal notranslate"><span class="pre">Deque</span></code> should not modify the <code class="xref py py-class docutils literal notranslate"><span class="pre">Deque</span></code>.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>You can create a list of length <code class="xref py py-obj docutils literal notranslate"><span class="pre">n</span></code> containing only
<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">None</span></code></a> using the following syntax:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span>
</pre></div>
</div>
<p>The modulo operator, <code class="xref py py-obj docutils literal notranslate"><span class="pre">%</span></code> and integer division operator <code class="xref py py-obj docutils literal notranslate"><span class="pre">//</span></code> are also likely
to be very useful.</p>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>When removing an item from the <code class="xref py py-class docutils literal notranslate"><span class="pre">Deque</span></code>, it is important to
actually overwrite the place in the ring buffer occupied by that item,
perhaps with <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>. Failing to do so can cause a program to “leak”
memory (i.e. fail to free memory that is no longer needed).</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You may not use <a class="reference external" href="https://docs.python.org/3/library/collections.html#collections.deque" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.deque</span></code></a> to implement this exercise.</p>
</div>
</div></div><p class="rubric">Footnotes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="exercise-page" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">1</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://oxmmscpython.github.io/exercises.html">https://oxmmscpython.github.io/exercises.html</a></p>
</aside>
</aside>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019-2023, David A. Ham.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 6.2.1.
    </div>
  </body>
</html>